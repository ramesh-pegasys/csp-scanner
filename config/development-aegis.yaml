# config/development-aegis.yaml
app_name: "Cloud Artifact Extractor"
environment: "development"
# debug: false

enabled_providers:
  - "aws"
  - "gcp"
  - "azure"

ssl:
  certfile: "certs/server.crt"
  keyfile: "certs/server.key"

# Transport configuration
transport:
  type: "aegis_policy_scanner"
  aegis_host: "aegis.example.com"
  policy_name: "default-cloud-policy"
  # Token should be set in environment: AEGIS_TOKEN
  max_concurrent_requests: 5
  max_retries: 3
  allow_insecure_ssl: true  # Allow insecure HTTPS connections (not recommended for production)
  http_endpoint_url: "https://aegis.example.com/api/v1/scan"
  labels:
    env: "dev"
    team: "security"

# --- Sample transport configs ---
#
# transport:
#   type: "http"
#   http_endpoint_url: "https://scanner.example.com/api/artifacts"
#   api_key: "your-api-key-here"
#   timeout_seconds: 30
#   max_retries: 3
#   headers:
#     Content-Type: "application/json"
#     User-Agent: "CloudArtifactExtractor/1.0"
#
# transport:
#   type: "filesystem"
#   base_dir: "./file_collector"
#   create_dir: true
#
# transport:
#   type: "null"
#   # No additional config needed

# AWS multi-account configuration
# Policy hierarchy: region-level > account-level > cloud-level > transport default
# Note: All policy_name fields are optional at every level
aws_accounts:
  # policy_name: "aws-cloud-policy"  # Optional: Cloud-level policy for all AWS resources
  accounts:
    - account_id: "123456789012"
      policy_name: "aws-account-123456789012-policy"  # Optional: Account-level policy
      regions:
        - name: "us-west-2"
          policy_name: "aws-us-west-2-policy"  # Optional: Region-level policy (highest priority)
        - name: "us-east-1"
          policy_name: "aws-us-east-1-policy"
    - account_id: "123456789013"
      # No account-level policy, will fall back to cloud or transport level
      regions:
        - name: "eu-west-1"
          policy_name: "aws-eu-west-1-policy"
        - name: "eu-central-1"
          # No region-level policy, will use account, cloud, or transport level

# GCP multi-project configuration
gcp_projects:
  # policy_name: "gcp-cloud-policy"  # Optional: Cloud-level policy for all GCP resources
  projects:
    - project_id: "first-project"
      policy_name: "gcp-first-project-policy"  # Optional: Project-level policy
      regions:
        - name: "us-central1"
          policy_name: "gcp-us-central1-policy"  # Optional: Region-level policy
        - name: "us-east1"
          # No region-level policy, will use project, cloud, or transport level
    - project_id: "second-project"
      # No project-level policy defined
      regions:
        - name: "europe-west1"
          policy_name: "gcp-europe-west1-policy"

# Azure configuration
azure_subscriptions:
  # policy_name: "azure-cloud-policy"  # Optional: Cloud-level policy for all Azure resources
  subscriptions:
    - subscription_id: "sub-123"
      policy_name: "azure-sub-123-policy"  # Optional: Subscription-level policy
      locations:
        - name: "eastus"
          # No location-level policy, will use subscription, cloud, or transport level
        - name: "westeurope"
          policy_name: "azure-westeurope-policy"  # Optional: Location-level policy
    - subscription_id: "sub-456"
      locations:
        - name: "northeurope"

# Other extractor settings
batch_size: 50
batch_delay_seconds: 0.5

